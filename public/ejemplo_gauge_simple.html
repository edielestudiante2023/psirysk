<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ejemplo Simple - Gr√°fico de Veloc√≠metro</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Chart.js + plugin de datalabels -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0"></script>

    <style>
        body {
            background: #f5f5f5;
            padding: 2rem;
        }
        .gauge-container {
            background: white;
            border-radius: 10px;
            padding: 2rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            max-width: 800px;
            margin: 0 auto;
        }
        .gauge-title {
            text-align: center;
            font-weight: bold;
            font-size: 1.3rem;
            margin-bottom: 1rem;
        }
        .gauge-score {
            text-align: center;
            margin-top: -60px;
            margin-bottom: 1rem;
        }
        .gauge-score-value {
            font-size: 2rem;
            font-weight: bold;
            background: white;
            padding: 0.5rem 1.5rem;
            border-radius: 5px;
            display: inline-block;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .baremos-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 0.5rem;
            margin-top: 1.5rem;
        }
        .baremo-card {
            border: 2px solid;
            border-radius: 8px;
            padding: 0.8rem;
            text-align: center;
        }
        .baremo-card.escala-1 { border-color: #28a745; background-color: #d4edda; }
        .baremo-card.escala-2 { border-color: #90ee90; background-color: #e8f8e8; }
        .baremo-card.escala-3 { border-color: #ffc107; background-color: #fff9e6; }
        .baremo-card.escala-4 { border-color: #dc3545; background-color: #f8d7da; }
        .baremo-card.escala-5 { border-color: #8b0000; background-color: #ffe0e0; }
        .baremo-header { font-size: 0.9rem; font-weight: bold; margin-bottom: 0.5rem; }
        .baremo-range { font-size: 1.1rem; font-weight: bold; }

        /* Contenedor del gauge (canvas + aguja) */
        .gauge-wrapper {
            position: relative;
            height: 300px;
            margin-bottom: 1rem;
        }

        /* Aguja en HTML encima del canvas */
        .needle {
            position: absolute;
            left: 50%;
            top: 50%;
            width: 2px;
            height: 45%;
            background: #000;
            transform-origin: bottom center;
            transform: rotate(0deg); /* se reemplaza por JS */
        }

        /* Punto central de la aguja */
        .needle::after {
            content: "";
            position: absolute;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #000;
            bottom: -6px;
            left: 50%;
            transform: translateX(-50%);
        }
    </style>
</head>
<body>
    <div class="container">
        <h2 class="text-center mb-4">Ejemplo Simple: 5 Escalas Iguales (20 puntos cada una)</h2>

        <div class="gauge-container">
            <div class="gauge-title">Puntaje con 5 Escalas Uniformes</div>

            <!-- Canvas + Aguja -->
            <div class="gauge-wrapper">
                <canvas id="gaugeChart"></canvas>
                <div class="needle" id="needle"></div>
            </div>

            <div class="gauge-score">
                <div class="gauge-score-value" id="scoreBox">45</div>
            </div>

            <!-- Baremos -->
            <div class="baremos-grid">
                <div class="baremo-card escala-1">
                    <div class="baremo-header">Escala 1</div>
                    <div class="baremo-range">0 - 20</div>
                </div>
                <div class="baremo-card escala-2">
                    <div class="baremo-header">Escala 2</div>
                    <div class="baremo-range">20 - 40</div>
                </div>
                <div class="baremo-card escala-3">
                    <div class="baremo-header">Escala 3</div>
                    <div class="baremo-range">40 - 60</div>
                </div>
                <div class="baremo-card escala-4">
                    <div class="baremo-header">Escala 4</div>
                    <div class="baremo-range">60 - 80</div>
                </div>
                <div class="baremo-card escala-5">
                    <div class="baremo-header">Escala 5</div>
                    <div class="baremo-range">80 - 100</div>
                </div>
            </div>

            <div class="alert alert-info mt-4">
                <strong>Explicaci√≥n:</strong> Cada escala tiene exactamente 20 puntos (0-20, 20-40, 40-60, 60-80, 80-100).
                El puntaje de <strong>45</strong> cae en la Escala 3 (40-60).
            </div>
        </div>
    </div>

    <script>
        // Registramos el plugin de datalabels
        Chart.register(ChartDataLabels);

        const ctx = document.getElementById('gaugeChart');
        const needle = document.getElementById('needle');

        const score = 45; // Puntaje ejemplo 0‚Äì100
        document.getElementById('scoreBox').textContent = score;

        // √Ångulo de la aguja en grados (-90 a 90)
        const angleDeg = -90 + (score / 100) * 180;
        needle.style.transform = `rotate(${angleDeg}deg)`;

        const chart = new Chart(ctx, {
            type: 'doughnut',
            data: {
                // las etiquetas son solo para identificar cada tramo
                labels: ['0 - 20', '20 - 40', '40 - 60', '60 - 80', '80 - 100'],
                datasets: [{
                    data: [20, 20, 20, 20, 20],
                    backgroundColor: [
                        '#28a745',
                        '#90ee90',
                        '#FFFF00',
                        '#dc3545',
                        '#8b0000'
                    ],
                    borderWidth: 3,
                    borderColor: '#fff'
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                cutout: '70%',
                circumference: 180, // semic√≠rculo
                rotation: -90,     // empieza a la izquierda
                plugins: {
                    legend: { display: false },
                    tooltip: { enabled: false },
                    // üîπ Etiquetas de datos en cada tramo
                    datalabels: {
                        color: '#000',
                        font: { weight: 'bold', size: 11 },
                        formatter: (value, ctx) => ctx.chart.data.labels[ctx.dataIndex],
                        anchor: 'center',
                        align: 'end',
                        offset: -10
                    }
                }
            }
        });
    </script>
</body>
</html>
